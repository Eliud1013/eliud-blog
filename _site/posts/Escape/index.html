<!DOCTYPE html>






 

 

<!-- `site.alt_lang` can specify a language different from the UI -->
<html
  lang="en"
  data-mode="dark"
>
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta
    name="theme-color"
    media="(prefers-color-scheme: light)"
    content="#f7f7f7"
  />
  <meta
    name="theme-color"
    media="(prefers-color-scheme: dark)"
    content="#1b1b1e"
  />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta
    name="apple-mobile-web-app-status-bar-style"
    content="black-translucent"
  />
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  /><!-- Setup Open Graph image -->

   <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="HTB: Escape Writeup" />
<meta property="og:locale" content="en" />
<meta name="description" content="Scape is a Medium Windows AD machine. It starts with an SMB share exposing a PDF containing MSSQL credentials. The attacker forces MSSQL to authenticate and captures a crackable hash. With these credentials, they gain command execution using WinRM. Further enumeration reveals user credentials, and a vulnerable certificate template (ESC1) allows the attacker to request a certificate for the Administrator account, ultimately obtaining the Administrator’s hash." />
<meta property="og:description" content="Scape is a Medium Windows AD machine. It starts with an SMB share exposing a PDF containing MSSQL credentials. The attacker forces MSSQL to authenticate and captures a crackable hash. With these credentials, they gain command execution using WinRM. Further enumeration reveals user credentials, and a vulnerable certificate template (ESC1) allows the attacker to request a certificate for the Administrator account, ultimately obtaining the Administrator’s hash." />
<link rel="canonical" href="/posts/Escape/" />
<meta property="og:url" content="/posts/Escape/" />
<meta property="og:site_name" content="Elixir1013" />
<meta property="og:image" content="https://labs.hackthebox.com/storage/avatars/80936664b3da83a92b28602e79e47d79.png" />
<meta property="og:image:alt" content="Machine Icon" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-10-05T05:00:00-07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://labs.hackthebox.com/storage/avatars/80936664b3da83a92b28602e79e47d79.png" />
<meta name="twitter:image:alt" content="Machine Icon" />
<meta property="twitter:title" content="HTB: Escape Writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-05T05:00:00-07:00","datePublished":"2024-10-05T05:00:00-07:00","description":"Scape is a Medium Windows AD machine. It starts with an SMB share exposing a PDF containing MSSQL credentials. The attacker forces MSSQL to authenticate and captures a crackable hash. With these credentials, they gain command execution using WinRM. Further enumeration reveals user credentials, and a vulnerable certificate template (ESC1) allows the attacker to request a certificate for the Administrator account, ultimately obtaining the Administrator’s hash.","headline":"HTB: Escape Writeup","image":{"alt":"Machine Icon","url":"https://labs.hackthebox.com/storage/avatars/80936664b3da83a92b28602e79e47d79.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Escape/"},"url":"/posts/Escape/"}</script>
<!-- End Jekyll SEO tag -->


  <title>HTB: Escape Writeup | Elixir1013
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Elixir1013">
<meta name="application-name" content="Elixir1013">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
     <link
  rel="preconnect" href="https://fonts.googleapis.com" >  <link
  rel="dns-prefetch" href="https://fonts.googleapis.com" >    <link
  rel="preconnect" href="https://fonts.gstatic.com" crossorigin>  <link
  rel="dns-prefetch" href="https://fonts.gstatic.com" >    <link
  rel="preconnect" href="https://cdn.jsdelivr.net" >  <link
  rel="dns-prefetch" href="https://cdn.jsdelivr.net" >   

  <!-- Bootstrap -->
  
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
  />
  

  <!-- Theme style -->
  <link
    rel="stylesheet"
    href="/assets/css/jekyll-theme-chirpy.css"
  />

  <!-- Stars -->
  <link rel="stylesheet" href="/assets/css/stars.css" />

  <!-- Web Font -->
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"
  />

  <!-- Font Awesome Icons -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"
  />

  <!-- 3rd-party Dependencies -->

  
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"
  />
   
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"
  />
   
  <!-- Image Popup -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"
  />
  

  <!-- JavaScript -->

   <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Elixir1013</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">This is a personal cybersecurity blog that breaks down challenges across various categories. Here you will find detailed writeups, solutions to challenges from multiple platforms, and general resources on cybersecurity</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT ME</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/Eliud1013"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['eliud101xz','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/eliud-gaxiola-6678b7215/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>HTB: Escape Writeup</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main
            aria-label="Main Content"
            class="col-12 col-lg-11 col-xl-9 px-md-4"
          >
             <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>HTB: Escape Writeup</h1>
    
    <p class="post-desc fw-light mb-4">Scape is a Medium Windows AD machine. It starts with an SMB share exposing a PDF containing MSSQL credentials. The attacker forces MSSQL to authenticate and captures a crackable hash. With these credentials, they gain command execution using WinRM. Further enumeration reveals user credentials, and a vulnerable certificate template (ESC1) allows the attacker to request a certificate for the Administrator account, ultimately obtaining the Administrator's hash.</p>
    
    <div class="clouds-post"></div>
    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1728129600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct  5, 2024
</time>

      </span>

      <!-- lastmod date -->
           

      <div class="mt-3 mb-3">
        <a href="https://labs.hackthebox.com/storage/avatars/80936664b3da83a92b28602e79e47d79.png" class="popup img-link preview-img-post shimmer"><img src="https://labs.hackthebox.com/storage/avatars/80936664b3da83a92b28602e79e47d79.png"  alt="Machine Icon" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">
          Machine Icon
        </figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2267 words"
>
  <em>12 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content"><hr />

<h2 id="machine-information"><span class="me-2"><strong>Machine Information</strong></span><a href="#machine-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="synopsis"><span class="me-2"><strong>Synopsis</strong></span><a href="#synopsis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Scape is a Medium difficulty Windows Active Directory machine that starts with an SMB share that guest authenticated users can download a sensitive PDF file. Inside the PDF file temporary credentials are available for accessing an MSSQL service running on the machine. An attacker is able to force the MSSQL service to authenticate to his machine and capture the hash. It turns out that the service is running under a user account and the hash is crackable. Having a valid set of credentials an attacker is able to get command execution on the machine using WinRM. Enumerating the machine, a log file reveals the credentials for the user <code class="language-plaintext highlighter-rouge">ryan.cooper</code>. Further enumeration of the machine, reveals that a Certificate Authority is present and one certificate template is vulnerable to the ESC1 attack, meaning that users who are legible to use this template can request certificates for any other user on the domain including Domain Administrators. Thus, by exploiting the ESC1 vulnerability, an attacker is able to obtain a valid certificate for the Administrator account and then use it to get the hash of the administrator user.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th style="text-align: left">Machine</th>
      <th>Nest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">OS</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td style="text-align: left">Dificulty</td>
      <td>Medium</td>
    </tr>
    <tr>
      <td style="text-align: left">Stars</td>
      <td>4.7</td>
    </tr>
    <tr>
      <td style="text-align: left">Release Date</td>
      <td>25 02 2023</td>
    </tr>
    <tr>
      <td style="text-align: left">Machine Address</td>
      <td>10.10.11.202</td>
    </tr>
  </tbody>
</table></div>

<hr />

<h2 id="recon"><span class="me-2"><strong>Recon</strong></span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="nmap"><span class="me-2"><strong>Nmap</strong></span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>First, let’s begin by enumerating services on the machine using Nmap.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">-sSVC</span> <span class="nt">--min-rate</span> 7000 <span class="nt">-n</span> <span class="nt">--min-parallelism</span> 100 <span class="nt">-oN</span> machine_services.txt 10.10.11.202
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-09-26 22:51 MST
Nmap scan report <span class="k">for </span>10.10.11.202
Host is up <span class="o">(</span>0.11s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65515 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span class="o">(</span>server <span class="nb">time</span>: 2024-09-27 13:51:58Z<span class="o">)</span>
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span class="o">)</span>
|_ssl-date: 2024-09-27T13:53:30+00:00<span class="p">;</span> +8h00m00s from scanner time.
| ssl-cert: Subject:
| Subject Alternative Name: DNS:dc.sequel.htb, DNS:sequel.htb, DNS:sequel
| Not valid before: 2024-01-18T23:03:57
|_Not valid after:  2074-01-05T23:03:57
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span class="o">)</span>
| ssl-cert: Subject:
| Subject Alternative Name: DNS:dc.sequel.htb, DNS:sequel.htb, DNS:sequel
| Not valid before: 2024-01-18T23:03:57
|_Not valid after:  2074-01-05T23:03:57
|_ssl-date: 2024-09-27T13:53:31+00:00<span class="p">;</span> +8h00m00s from scanner time.
1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00<span class="p">;</span> RTM
| ms-sql-ntlm-info:
|   10.10.11.202:1433:
|     Target_Name: sequel
|     NetBIOS_Domain_Name: sequel
|     NetBIOS_Computer_Name: DC
|     DNS_Domain_Name: sequel.htb
|     DNS_Computer_Name: dc.sequel.htb
|     DNS_Tree_Name: sequel.htb
|_    Product_Version: 10.0.17763
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>SSL_Self_Signed_Fallback
| Not valid before: 2024-09-27T12:51:30
|_Not valid after:  2054-09-27T12:51:30
|_ssl-date: 2024-09-27T13:53:30+00:00<span class="p">;</span> +7h59m59s from scanner time.
| ms-sql-info:
|   10.10.11.202:1433:
|     Version:
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: <span class="nb">false</span>
|_    TCP port: 1433
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span class="o">)</span>
|_ssl-date: 2024-09-27T13:53:30+00:00<span class="p">;</span> +8h00m00s from scanner time.
| ssl-cert: Subject:
| Subject Alternative Name: DNS:dc.sequel.htb, DNS:sequel.htb, DNS:sequel
| Not valid before: 2024-01-18T23:03:57
|_Not valid after:  2074-01-05T23:03:57
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span class="o">)</span>
|_ssl-date: 2024-09-27T13:53:31+00:00<span class="p">;</span> +8h00m00s from scanner time.
| ssl-cert: Subject:
| Subject Alternative Name: DNS:dc.sequel.htb, DNS:sequel.htb, DNS:sequel
| Not valid before: 2024-01-18T23:03:57
|_Not valid after:  2074-01-05T23:03:57
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49689/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49690/tcp open  msrpc         Microsoft Windows RPC
49702/tcp open  msrpc         Microsoft Windows RPC
49713/tcp open  msrpc         Microsoft Windows RPC
49743/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: DC<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time:
|   <span class="nb">date</span>: 2024-09-27T13:52:54
|_  start_date: N/A
|_clock-skew: mean: 7h59m59s, deviation: 0s, median: 7h59m59s
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required

</pre></td></tr></tbody></table></code></div></div>

<p>We’re clearly dealing with a domain controller, as it is running services such as DNS, Kerberos, LDAP, etc. Besides the usual services, we can also see that the server is running MSSQL.</p>

<p>The script <code class="language-plaintext highlighter-rouge">ms-sql-ntlm-info</code> reveals the domain name (<code class="language-plaintext highlighter-rouge">sequel.htb</code>) and also the NetBIOS and DNS name for the domain controller.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00<span class="p">;</span> RTM
| ms-sql-ntlm-info:
|   10.10.11.202:1433:
|     Target_Name: sequel
|     NetBIOS_Domain_Name: sequel
|     NetBIOS_Computer_Name: DC
|     DNS_Domain_Name: sequel.htb
|     DNS_Computer_Name: dc.sequel.htb
|     DNS_Tree_Name: sequel.htb
|_    Product_Version: 10.0.17763
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s add that hostname to our hosts file.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"10.10.11.202</span><span class="se">\t</span><span class="s2">sequel.htb dc.sequel.htb"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts
10.10.11.202    sequel.htb dc.sequel.htb
</pre></td></tr></tbody></table></code></div></div>

<h3 id="smb-enumeration"><span class="me-2"><strong>SMB Enumeration</strong></span><a href="#smb-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="guest-session"><span class="me-2"><strong>Guest Session</strong></span><a href="#guest-session" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>We can try to get a guest session on SMB, to do this we can use variety of tools, I’m going to use <code class="language-plaintext highlighter-rouge">Crackmapexec</code>.</p>

<p>To establish a valid guest session, we need to provide a username and an empty password. If we specify a username and a password or if we provide neither, we will get a valid SMB session but we will be unable to connect to any shared resources.</p>

<p><a href="/assets/img/HackTheBox/Escape/img_2.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_2.png" alt="img_2" loading="lazy"></a>
<a href="/assets/img/HackTheBox/Escape/img_1.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_1.png" alt="img_1" loading="lazy"></a></p>

<p>That’s the case with any tool you use, this behavior has more to do with SMB and server configurations. If you provide a valid username, whether you provide a password or not you won’t even get a smb sessios. This could be a way to enumerate users…
<a href="/assets/img/HackTheBox/Escape/img_3.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_3.png" alt="img_3" loading="lazy"></a></p>

<p>Now let’s take a look at the shared resources…
<a href="/assets/img/HackTheBox/Escape/img_4.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_4.png" alt="img_4" loading="lazy"></a></p>

<p>We have access to <code class="language-plaintext highlighter-rouge">Public</code> share, I’m going to use <code class="language-plaintext highlighter-rouge">smbclient</code> and download its contents.
<a href="/assets/img/HackTheBox/Escape/img_5.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_5.png" alt="img_5" loading="lazy"></a></p>

<h3 id="pdf-document"><span class="me-2"><strong>PDF Document</strong></span><a href="#pdf-document" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>If we open the document, we’ll notice that Ryan has messed up by installing some kind of mock instance on the domain controller haha. By the way, at the end, there appear to be database credentials for new employees or something like that.
<a href="/assets/img/HackTheBox/Escape/img_6.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_6.png" alt="img_6" loading="lazy"></a></p>

<p>Let’s try to access to the domain controller’s MSSQL instance with those Credentials.</p>

<h3 id="mssql-instance"><span class="me-2"><strong>MSSQL Instance</strong></span><a href="#mssql-instance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>I’m gonna use Impacket’s mssqlclient to access the database.
<a href="/assets/img/HackTheBox/Escape/img_7.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_7.png" alt="img_7" loading="lazy"></a>
There are not tables besides of the default ones. We can try enabling xp_cmdshell but it will fail.</p>

<p>At this point, we can attempt to use the <code class="language-plaintext highlighter-rouge">xp_dirtree</code> stored procedure to trigger an NTLMv2 authentication and capture the hash using <code class="language-plaintext highlighter-rouge">Responder</code>.</p>

<p><a href="/assets/img/HackTheBox/Escape/img_8.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_8.png" alt="img_8" loading="lazy"></a></p>

<p>And there it is… An NTLMv2 hash for the <code class="language-plaintext highlighter-rouge">sql_svc</code> user.</p>

<hr />

<h2 id="foothold"><span class="me-2"><strong>Foothold</strong></span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="cracking-the-hash"><span class="me-2"><strong>Cracking the Hash</strong></span><a href="#cracking-the-hash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Now I’m gonna use <code class="language-plaintext highlighter-rouge">Hashcat</code> to try to crack that hash and get access to <code class="language-plaintext highlighter-rouge">sql_svc</code> account.</p>

<p>As Hashcat requires us to provide appropiate hash mode for NetNTLMv2, we can easily find it using <code class="language-plaintext highlighter-rouge">grep</code> and <code class="language-plaintext highlighter-rouge">--example-hashes</code> flag in Hashcat.
<a href="/assets/img/HackTheBox/Escape/img_9.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_9.png" alt="img_9" loading="lazy"></a></p>

<p>Now let’s get the password for the <code class="language-plaintext highlighter-rouge">sql_svc</code> user.
<a href="/assets/img/HackTheBox/Escape/img_10.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_10.png" alt="img_10" loading="lazy"></a></p>

<h3 id="gaining-a-shell-as-sql_svc"><span class="me-2"><strong>Gaining a shell as sql_svc</strong></span><a href="#gaining-a-shell-as-sql_svc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Now that we’ve gained access to a new account, I will quickly look for it’s account memberships using <code class="language-plaintext highlighter-rouge">pywerview</code>, a Python implementation of <code class="language-plaintext highlighter-rouge">PowerView</code>.
<a href="/assets/img/HackTheBox/Escape/img_11.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_11.png" alt="img_11" loading="lazy"></a></p>

<p>As we can see, the <code class="language-plaintext highlighter-rouge">sql_svc</code> is member of <code class="language-plaintext highlighter-rouge">Remote Management Users</code>, which means that we can use WinRM to establish a remote PowerShell session. Let’s use Evil-WinRM.
<a href="/assets/img/HackTheBox/Escape/img_12.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_12.png" alt="img_12" loading="lazy"></a></p>

<p>And nice, we’ve got a shell!</p>

<h3 id="ryancooper-credentials"><span class="me-2"><strong>Ryan.Cooper Credentials</strong></span><a href="#ryancooper-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Now that we have gained foothold, we could re-enumerate SMB shares providing credentials, enumerate LDAP, run SharpHound and analyze domain ACEs and so on. But first things first, why not start with some basic enumeration in the system?</p>

<p>If we go to the root of the filesystem, we’ll notice a folder named <code class="language-plaintext highlighter-rouge">SQLServer</code>. Since our current user is <code class="language-plaintext highlighter-rouge">sql_svc</code>, why not we take a look?
<a href="/assets/img/HackTheBox/Escape/img_13.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_13.png" alt="img_13" loading="lazy"></a></p>

<p>We can see that there is a file named <code class="language-plaintext highlighter-rouge">ERRORLOG.BAK</code>. Since it contains a significant number of lines, I’ll take a look at the entire file and then search by using keywords as I tend to miss things.
<a href="/assets/img/HackTheBox/Escape/img_14.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_14.png" alt="img_14" loading="lazy"></a></p>

<p>If we filter for some keywords such as password, user, login, we will find something funnny.
<a href="/assets/img/HackTheBox/Escape/img_15.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_15.png" alt="img_15" loading="lazy"></a>
It seems that the user <code class="language-plaintext highlighter-rouge">Ryan.Copper</code> typed his password as a username, and MSSQL logged it as a failed login.</p>

<p>Now we can verify this credentials using Crackmapexec.
<a href="/assets/img/HackTheBox/Escape/img_16.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_16.png" alt="img_16" loading="lazy"></a>
Specifying a invalid password is how we can determine wheter this user exists or not. If the user didn’t exist we’d receive a valid SMB session. However, since the user exists we need to provide valid credentials to establish a session.</p>

<hr />

<h2 id="privilege-escalation"><span class="me-2"><strong>Privilege Escalation</strong></span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="ad-cs"><span class="me-2"><strong>AD CS</strong></span><a href="#ad-cs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>If we log in as <code class="language-plaintext highlighter-rouge">Ryan.Cooper</code> and list running processes, we’ll notice that there is a service called <code class="language-plaintext highlighter-rouge">certsrv</code>, which is present on CA servers. CA servers do not necessarily have to be running on a DC; like KDCs, CA server might operate (and usually do) on dedicated servers.</p>

<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="o">*</span><span class="n">Evil-WinRM</span><span class="o">*</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Temp</span><span class="w"> </span><span class="nx">get-process</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nx">name</span><span class="w">

</span><span class="n">Name</span><span class="w">
</span><span class="o">----</span><span class="w">
</span><span class="n">certsrv</span><span class="w"> </span><span class="err">&lt;</span><span class="w">
</span><span class="n">csrss</span><span class="w">
</span><span class="nx">csrss</span><span class="w">
</span><span class="n">dfsrs</span><span class="w">
</span><span class="nx">dfssvc</span><span class="w">
</span><span class="n">dllhost</span><span class="w">
</span><span class="nx">dns</span><span class="w">
</span><span class="n">dwm</span><span class="w">
</span><span class="nx">fontdrvhost</span><span class="w">
</span><span class="n">fontdrvhost</span><span class="w">
</span><span class="nx">Idle</span><span class="w">
</span><span class="n">ismserv</span><span class="w">
</span><span class="nx">LogonUI</span><span class="w">
</span><span class="n">lsass</span><span class="w">
</span><span class="nx">Microsoft.ActiveDirectory.WebServices</span><span class="w">
</span><span class="n">msdtc</span><span class="w">
</span><span class="nx">Registry</span><span class="w">
</span><span class="n">services</span><span class="w">
</span><span class="nx">smss</span><span class="w">
</span><span class="o">...</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>So, knowing that this AD environment has implemented AD CS, it’s worth checking if we have enrollment rights in any templates, and then looking for misconfigurations. We might find some privilage escalation paths.</p>

<h4 id="bloodhound"><span class="me-2"><strong>BloodHound</strong></span><a href="#bloodhound" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Enumerating certification templates manually can be exhausting. Fortunately SharpHound implements AD CS data collection methods.
This only works with <code class="language-plaintext highlighter-rouge">BloodHound Community Edition</code>, which you can download from it’s <a href="https://github.com/SpecterOps/BloodHound.git">GitHub Repository</a></p>

<p><a href="/assets/img/HackTheBox/Escape/img_18.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_18.png" alt="img_18" loading="lazy"></a></p>

<p>Then, you can transfer SharpHound to the machine, execute it, and retrieve the domain information to your machine, then upload the data to BloodHound and start analizyng :D</p>

<p>If we search for the shortest paths from <code class="language-plaintext highlighter-rouge">Ryan.Cooper</code> to <code class="language-plaintext highlighter-rouge">Domain Admins</code>, we will find the following path:</p>

<p><a href="/assets/img/HackTheBox/Escape/img_19.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_19.png" alt="img_19" loading="lazy"></a></p>

<p>Domain users can perform the ESC1 attack by using <code class="language-plaintext highlighter-rouge">UserAuthentication</code> template. This basically means that we can request a certificate that can be used for authentication and we have permission to specify a SAN (Subject Alternative Name) in our CSR (Certificate Signing Request), allowing us to authenticate as any user in the domain.</p>

<h3 id="certipy"><span class="me-2"><strong>Certipy</strong></span><a href="#certipy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Certipy is an offensive tool for enumerating and abusing Active Directory Certificate Services (AD CS). We can download it from its <a href="https://github.com/ly4k/Certipy">GitHub repository</a>.</p>

<h4 id="finding-misconfigured-templates"><span class="me-2"><strong>Finding Misconfigured Templates</strong></span><a href="#finding-misconfigured-templates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>We can run the following command to enumerate misconfigured templates.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre></td><td class="rouge-code"><pre>certipy-ad find <span class="nt">-vulnerable</span> <span class="nt">-u</span> <span class="s2">"ryan.cooper"</span> <span class="nt">-p</span> <span class="s2">"NuclearMosquito3"</span> <span class="nt">-dc-ip</span> 10.10.11.202 <span class="nt">-stdout</span>
Certipy v4.8.2 - by Oliver Lyak <span class="o">(</span>ly4k<span class="o">)</span>

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Finding certificate templates
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found 34 certificate templates
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Finding certificate authorities
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found 1 certificate authority
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found 12 enabled certificate templates
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Trying to get CA configuration <span class="k">for</span> <span class="s1">'sequel-DC-CA'</span> via CSRA
<span class="o">[!]</span> Got error <span class="k">while </span>trying to get CA configuration <span class="k">for</span> <span class="s1">'sequel-DC-CA'</span> via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Trying to get CA configuration <span class="k">for</span> <span class="s1">'sequel-DC-CA'</span> via RRP
<span class="o">[!]</span> Failed to connect to remote registry. Service should be starting now. Trying again...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Got CA configuration <span class="k">for</span> <span class="s1">'sequel-DC-CA'</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Enumeration output:
Certificate Authorities
  0
    CA Name                             : sequel-DC-CA
    DNS Name                            : dc.sequel.htb
    Certificate Subject                 : <span class="nv">CN</span><span class="o">=</span>sequel-DC-CA, <span class="nv">DC</span><span class="o">=</span>sequel, <span class="nv">DC</span><span class="o">=</span>htb
    Certificate Serial Number           : 1EF2FA9A7E6EADAD4F5382F4CE283101
    Certificate Validity Start          : 2022-11-18 20:58:46+00:00
    Certificate Validity End            : 2121-11-18 21:08:46+00:00
    Web Enrollment                      : Disabled
    User Specified SAN                  : Disabled
    Request Disposition                 : Issue
    Enforce Encryption <span class="k">for </span>Requests     : Enabled
    Permissions
      Owner                             : SEQUEL.HTB<span class="se">\A</span>dministrators
      Access Rights
        ManageCertificates              : SEQUEL.HTB<span class="se">\A</span>dministrators
                                          SEQUEL.HTB<span class="se">\D</span>omain Admins
                                          SEQUEL.HTB<span class="se">\E</span>nterprise Admins
        ManageCa                        : SEQUEL.HTB<span class="se">\A</span>dministrators
                                          SEQUEL.HTB<span class="se">\D</span>omain Admins
                                          SEQUEL.HTB<span class="se">\E</span>nterprise Admins
        Enroll                          : SEQUEL.HTB<span class="se">\A</span>uthenticated Users
Certificate Templates
  0
    Template Name                       : UserAuthentication
    Display Name                        : UserAuthentication
    Certificate Authorities             : sequel-DC-CA
    Enabled                             : True
    Client Authentication               : True
    Enrollment Agent                    : False
    Any Purpose                         : False
    Enrollee Supplies Subject           : True
    Certificate Name Flag               : EnrolleeSuppliesSubject
    Enrollment Flag                     : PublishToDs
                                          IncludeSymmetricAlgorithms
    Private Key Flag                    : ExportableKey
    Extended Key Usage                  : Client Authentication
                                          Secure Email
                                          Encrypting File System
    Requires Manager Approval           : False
    Requires Key Archival               : False
    Authorized Signatures Required      : 0
    Validity Period                     : 10 years
    Renewal Period                      : 6 weeks
    Minimum RSA Key Length              : 2048
    Permissions
      Enrollment Permissions
        Enrollment Rights               : SEQUEL.HTB<span class="se">\D</span>omain Admins
                                          SEQUEL.HTB<span class="se">\D</span>omain Users
                                          SEQUEL.HTB<span class="se">\E</span>nterprise Admins
      Object Control Permissions
        Owner                           : SEQUEL.HTB<span class="se">\A</span>dministrator
        Write Owner Principals          : SEQUEL.HTB<span class="se">\D</span>omain Admins
                                          SEQUEL.HTB<span class="se">\E</span>nterprise Admins
                                          SEQUEL.HTB<span class="se">\A</span>dministrator
        Write Dacl Principals           : SEQUEL.HTB<span class="se">\D</span>omain Admins
                                          SEQUEL.HTB<span class="se">\E</span>nterprise Admins
                                          SEQUEL.HTB<span class="se">\A</span>dministrator
        Write Property Principals       : SEQUEL.HTB<span class="se">\D</span>omain Admins
                                          SEQUEL.HTB<span class="se">\E</span>nterprise Admins
                                          SEQUEL.HTB<span class="se">\A</span>dministrator
    <span class="o">[!]</span> Vulnerabilities
      ESC1                              : <span class="s1">'SEQUEL.HTB\\Domain Users'</span> can enroll, enrollee supplies subject and template allows client authentication

</pre></td></tr></tbody></table></code></div></div>

<p>And again, we find that the <code class="language-plaintext highlighter-rouge">UserAuthentication</code> template is vulnerable to ESC1. We can use Certipy to request a certificate, and since we can specify a SAN we can set it to <code class="language-plaintext highlighter-rouge">Administrator</code> by specifying a user principal name using the <code class="language-plaintext highlighter-rouge">-upn</code> option:</p>

<p><a href="/assets/img/HackTheBox/Escape/img_20.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_20.png" alt="img_20" loading="lazy"></a></p>

<p>And now we’ve got a PFX file that contains the certificate and a private key. I’ve really tried to get a shell using the certificate and private key with Evil-WinRM but it didn’t work on this machine.I guess WinRM over HTTPS hasn’t been implemented. IDK, just remember that Evil-WinRM has that feature.</p>

<h4 id="getting-administrator-credentials"><span class="me-2"><strong>Getting Administrator Credentials</strong></span><a href="#getting-administrator-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Certipy has also a feature to get a NTLM hash along with a TGT:
<a href="/assets/img/HackTheBox/Escape/img_21.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_21.png" alt="img_21" loading="lazy"></a>
Now we can perform a PtH to get a session as Administrator, I going to use <code class="language-plaintext highlighter-rouge">Evil-WinRM</code>.</p>

<p><a href="/assets/img/HackTheBox/Escape/img_22.png" class="popup img-link  shimmer"><img src="/assets/img/HackTheBox/Escape/img_22.png" alt="img_22" loading="lazy"></a>
And that’s it! We’ve got a shell as Administrator.</p>
</div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
    <div class="post-meta mb-3">
      <i class="far fa-folder-open fa-fw me-1"></i>
      
      <a
        href="/categories/hackthebox/"
        >HackTheBox</a
      >,
      <a
        href="/categories/ctf/"
        >CTF</a
      >
    </div>
    

    <!-- tags -->
    
    <div class="post-tags">
      <i class="fa fa-tags fa-fw me-1"></i>
      
      <a
        href="/tags/active-directory/"
        class="post-tag no-text-decoration"
      >Active Directory</a>
      
      <a
        href="/tags/mssql/"
        class="post-tag no-text-decoration"
      >MSSQL</a>
      
      <a
        href="/tags/reconnaissance/"
        class="post-tag no-text-decoration"
      >Reconnaissance</a>
      
      <a
        href="/tags/misconfiguration/"
        class="post-tag no-text-decoration"
      >Misconfiguration</a>
      
      <a
        href="/tags/common-services/"
        class="post-tag no-text-decoration"
      >Common Services</a>
      
      <a
        href="/tags/kerberos/"
        class="post-tag no-text-decoration"
      >Kerberos</a>
      
      <a
        href="/tags/impersonation/"
        class="post-tag no-text-decoration"
      >Impersonation</a>
      
      <a
        href="/tags/anonymous-guest-access/"
        class="post-tag no-text-decoration"
      >Anonymous/Guest Access</a>
      
      <a
        href="/tags/active-directory-certificate-services/"
        class="post-tag no-text-decoration"
      >Active Directory Certificate Services</a>
      
      <a
        href="/tags/analysis-of-logs/"
        class="post-tag no-text-decoration"
      >Analysis of Logs</a>
      
      <a
        href="/tags/password-reuse/"
        class="post-tag no-text-decoration"
      >Password Reuse</a>
      
      <a
        href="/tags/password-cracking/"
        class="post-tag no-text-decoration"
      >Password Cracking</a>
      
      <a
        href="/tags/pass-the-hash/"
        class="post-tag no-text-decoration"
      >Pass the Hash</a>
      
      <a
        href="/tags/windows-service-exploitation/"
        class="post-tag no-text-decoration"
      >Windows Service Exploitation</a>
      
      <a
        href="/tags/hash-capture/"
        class="post-tag no-text-decoration"
      >Hash Capture</a>
      
      <a
        href="/tags/enterprise-network/"
        class="post-tag no-text-decoration"
      >Enterprise Network</a>
      
      <a
        href="/tags/authentication/"
        class="post-tag no-text-decoration"
      >Authentication</a>
      
      <a
        href="/tags/vulnerability-assessment/"
        class="post-tag no-text-decoration"
      >Vulnerability Assessment</a>
      
    </div>
    

    <div
      class="post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2"
    >
      <div class="license-wrapper">
          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author. 
      </div>
    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>

 
          </main>

          <!-- panel -->
          <aside
            aria-label="Panel"
            id="panel-wrapper"
            class="col-xl-3 ps-2 mb-5 text-muted"
          >
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Escape/">HTB: Escape Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CheatSheet-net-Command/">Cheat Sheet: net Command</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Builder/">HTB: Builder Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Sauna/">HTB: Sauna Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Nest/">HTB: Nest Writeup</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->

 <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">You might be interested in</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reconnaissance/">Reconnaissance</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vulnerability-assessment/">Vulnerability Assessment</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/authentication/">Authentication</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/misconfiguration/">Misconfiguration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/password-cracking/">Password Cracking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/user-enumeration/">User Enumeration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/anonymous-guest-access/">Anonymous/Guest Access</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/enterprise-network/">Enterprise Network</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pass-the-hash/">Pass the Hash</a>
      
    </div>
  </section>


            </div>

              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>

 
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Sauna/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1725883200"
  data-df="ll"
  
>
  Sep  9, 2024
</time>

              <h4 class="pt-0 my-2">HTB: Sauna Writeup</h4>
              <div class="text-muted">
                <p>In this post, we&#39;re resolving Sauna Machine from HackTheBox, where we&#39;ll deal with an Active Directory environment. We will exploit AS-REP Roasting on a domain account, reading autologon credential...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Builder/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1726488000"
  data-df="ll"
  
>
  Sep 16, 2024
</time>

              <h4 class="pt-0 my-2">HTB: Builder Writeup</h4>
              <div class="text-muted">
                <p>Builder is a Medium HTB machine where we exploit Jenkins CVE-2024-23897, which allows us to read files on the server. We can retrieve user credentials by enumerating Jenkins configuration files, cr...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Nest/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1725364800"
  data-df="ll"
  
>
  Sep  3, 2024
</time>

              <h4 class="pt-0 my-2">HTB: Nest Writeup</h4>
              <div class="text-muted">
                <p>In this post we&#39;re resolving Nest machine from HackTheBox, this is cataloged as an easy Windows box where SMB guest access leads to low-privileged credentials. Dive into configuration files for sen...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->

   <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/CheatSheet-net-Command/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Cheat Sheet: net Command</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>
   <!-- The comments switcher -->

  <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3"
>
  <p>©
    <time>2024</time>

    
    <a href="https://www.linkedin.com/in/eliud-gaxiola-6678b7215/">Eliud</a>.  
  </p>

  <p>Using the <a
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="v7.1.0"
      href="https://github.com/cotes2020/jekyll-theme-chirpy"
      target="_blank"
      rel="noopener"
      >Chirpy</a
    > theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">You might be interested in</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reconnaissance/">Reconnaissance</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vulnerability-assessment/">Vulnerability Assessment</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/authentication/">Authentication</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/misconfiguration/">Misconfiguration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/password-cracking/">Password Cracking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/user-enumeration/">User Enumeration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/anonymous-guest-access/">Anonymous/Guest Access</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/enterprise-network/">Enterprise Network</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pass-the-hash/">Pass the Hash</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button
          id="back-to-top"
          type="button"
          class="btn btn-lg btn-box-shadow"
        >
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

     <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


 
<!-- image lazy-loading & popup & clipboard -->
      






  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js,npm/mermaid@11.0.2/dist/mermaid.min.js"></script>

  

<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->
 
   <!-- mermaid-js loader -->
<script type="text/javascript">
  function updateMermaid(event) {
    if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
      const mode = event.data.message;

      if (typeof mermaid === 'undefined') {
        return;
      }

      let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
      let config = { theme: expectedTheme };const mermaidList = document.getElementsByClassName('mermaid');

      [...mermaidList].forEach((elem) => {
        const svgCode = elem.previousSibling.children.item(0).innerHTML;
        elem.innerHTML = svgCode;
        elem.removeAttribute('data-processed');
      });

      mermaid.initialize(config);
      mermaid.init(undefined, '.mermaid');
    }
  }

  (function () {
    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme};const basicList = document.getElementsByClassName('language-mermaid');
    [...basicList].forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('d-none');let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);
    window.addEventListener('message', updateMermaid);
  })();
</script>
  
 <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
  <script>
    const numStars = 110;
    const starField = document.createElement("div");
    starField.className = "stars";
    document.body.appendChild(starField);

    for (let i = 0; i < numStars; i++) {
      const star = document.createElement("div");
      star.className = "star";

      const size = Math.random() * 2 + 1;
      star.style.width = `${size}px`;
      star.style.height = `${size}px`;

      star.style.top = `${Math.random() * 100}vh`;
      star.style.left = `${Math.random() * 100}vw`;

      const duration = Math.random() * 5 + 7;
      star.style.animationDuration = `${duration}s`;
      let delay = Math.random() * 2;
      if (i <= 50) {
        delay = 0;
      }
      star.style.animationDelay = `${delay}s`;

      starField.appendChild(star);
    }
  </script>
</html>

